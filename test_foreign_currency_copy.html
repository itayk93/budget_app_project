<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>בדיקת העתקת מטבע זר</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .example { background: #e8f4f8; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #2196F3; }
        .currency-btn { background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); color: white; padding: 5px 10px; border: none; border-radius: 4px; margin: 5px; }
        .flow { display: flex; align-items: center; gap: 15px; margin: 10px 0; }
        .arrow { font-size: 24px; color: #4CAF50; }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔄 בדיקת העתקת עסקאות עם מטבע זר</h1>
        
        <h2>📝 מה זה עושה?</h2>
        <p><strong>העתקה</strong> (לא העברה!) של עסקה מתזרים אחד לתזרים אחר עם המרת מטבע.</p>
        
        <div class="example">
            <h3>דוגמה מעשית:</h3>
            <div class="flow">
                <div>
                    <strong>תזרים שקלים:</strong><br>
                    "הוק פקדון EUR" - 198.6₪ (הוצאה)
                    <button class="currency-btn">EUR 🔄</button>
                </div>
                <div class="arrow">→</div>
                <div>
                    <strong>תזרים יורו:</strong><br>
                    "הוק פקדון EUR" - 50€ (הכנסה)
                </div>
            </div>
            <p><small>שער חליפין: 1 EUR = 3.972 ₪</small></p>
        </div>

        <h2>🎯 מטבעות נתמכים:</h2>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
            <div>• USD - דולר אמריקאי</div>
            <div>• EUR - יורו</div>
            <div>• GBP - פאונד</div>
            <div>• CHF - פרנק שוויצרי</div>
            <div>• JPY - ין יפני</div>
            <div>• CAD - דולר קנדי</div>
            <div>• AUD - דולר אוסטרלי</div>
            <div>• SEK - קרונה שוודית</div>
            <div>• NOK - קרונה נורבגית</div>
            <div>• DKK - קרונה דנית</div>
        </div>

        <h2>🔍 דוגמאות לזיהוי:</h2>
        <div class="example">
            <div>✅ "הוק פקדון EUR" → <button class="currency-btn">EUR 🔄</button></div>
            <div>✅ "קניית דולר USD" → <button class="currency-btn">USD 🔄</button></div>
            <div>✅ "פקדון יורו EURO" → <button class="currency-btn">EUR 🔄</button></div>
            <div>✅ "בנק הפועלים/GBP תשלום" → <button class="currency-btn">GBP 🔄</button></div>
            <div>❌ "רמי לוי/סניף ירושלים" → אין כפתור (אין מטבע זר)</div>
        </div>

        <h2>⚙️ איך זה עובד?</h2>
        <ol>
            <li><strong>זיהוי אוטומטי:</strong> המערכת מזהה מטבע זר בשם העסק</li>
            <li><strong>כפתור ירוק:</strong> מופיע כפתור עם סמל המטבע</li>
            <li><strong>מודל העתקה:</strong> נפתח מסך להזנת פרטי ההעתקה</li>
            <li><strong>בחירת תזרים:</strong> בחירה מרשימת התזרימים הקיימים</li>
            <li><strong>הזנת סכום:</strong> כמה מטבע זר קנית/מכרת</li>
            <li><strong>חישוב שער:</strong> המערכת מחשבת את שער החליפין</li>
            <li><strong>העתקה:</strong> יצירת עסקה חדשה בתזרים היעד</li>
        </ol>

        <div class="example">
            <h3>💡 למה זה שימושי?</h3>
            <p>כאשר אתה קונה מטבע זר, זו הוצאה בתזרים השקלים שלך אבל הכנסה בתזרים המטבע הזר. 
            המערכת עוזרת לך לרשום את זה נכון בשני התזרימים.</p>
        </div>

        <button onclick="startTest()" style="background: #2196F3; color: white; padding: 10px 20px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer;">
            🧪 התחל בדיקה עם נתונים מדומים
        </button>
    </div>

    <script>
        function startTest() {
            const mockData = {
                transactions: [
                    {
                        user_id: "test-user",
                        business_name: "הוק פקדון EUR",
                        payment_date: "2025-08-13",
                        amount: "-198.6",
                        currency: "ILS",
                        payment_method: "1234567890",
                        tempId: "test-1"
                    },
                    {
                        user_id: "test-user", 
                        business_name: "קניית דולר USD",
                        payment_date: "2025-08-12",
                        amount: "-350.0",
                        currency: "ILS",
                        payment_method: "1234567890",
                        tempId: "test-2"
                    },
                    {
                        user_id: "test-user",
                        business_name: "רמי לוי/סניף ירושלים",
                        payment_date: "2025-08-11",
                        amount: "-89.50",
                        currency: "ILS", 
                        payment_method: "1234567890",
                        tempId: "test-3"
                    }
                ],
                source: "bank_scraper",
                configName: "יהב - חשבון ראשי",
                accountNumber: "1234567890",
                count: 3
            };
            
            sessionStorage.setItem('bankScraperTransactions', JSON.stringify(mockData));
            alert('✅ נתונים מדומים נשמרו! מעביר למסך העלאה...');
            window.location.href = 'http://localhost:4000/upload';
        }
    </script>
</body>
</html>